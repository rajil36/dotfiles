LPContextMenus=function(){var e=null,t=null,n=[],o=[],c=[],r=[],l="all",i=!1,a=20;function s(e,t){var n=gettabid(t),c=gettaburl(t),r=o[e.menuItemId];sendLpImprove("sitelogin",{shareType:getShareType(r),copy:0,autologin:0,source:"context"}),handleFill(n,{url:c,topurl:c,docid:0,force:!1,docnum:0,cmd:"autofillaid",aid:r,source:"notrack"})}function u(e,t){var n=o[e.menuItemId];copyusername(n),sendLpImprove("copyitem",{itemtype:"username",source:"context"})}function d(e,t){var n=o[e.menuItemId];copypassword(n),sendLpImprove("sitelogin",{shareType:getShareType(n),copy:1,autologin:0,source:"context"}),sendLpImprove("copypass",{action:"sitepassword",source:"context"})}function p(e,t){var n=o[e.menuItemId];copyurl(n)}function m(e,t){var n=o[e.menuItemId],l=c[e.menuItemId],i=r[e.menuItemId];copyprop(n,l,0,-1,null,i),sendLpImprove("copyitem",{itemtype:l,source:"context"})}function f(e,t){var n=o[e.menuItemId];fillitem(n,null,null,0,null,"context")}function g(e,t){var n=o[e.menuItemId];fillform(n,null,null,null,null,null,"context")}function h(e,t){var n=o[e.menuItemId];editprofile(n,null,"context")}function x(e,t){var n=o[e.menuItemId];openeditsite(n),sendLpImprove("edititem",{itemtype:"Saved Site",source:"context"})}function I(e,t){var n=o[e.menuItemId],r=c[e.menuItemId];openeditsecurenote(n),sendLpImprove("edititem",{itemtype:r,source:"context"})}function y(e,t){for(var c=0===t?s:1==t?u:2==t?d:p,r=e.slice(0,a).sort(function(e,t){return e.name&&t.name?e.name.localeCompare(t.name):0}),i=0;i<r.length;i++){var m=e[i].useusername;m=void 0!==m&&m.length?" ("+m+")":"";var f=chrome.contextMenus.create({title:e[i].name+m,contexts:[l],parentId:n[t],onclick:c});o[f]=e[i].aid,n[n.length]=f}e.length>a&&(n[n.length]=chrome.contextMenus.create({type:"separator",contexts:[l],parentId:n[t]}),n[n.length]=chrome.contextMenus.create({title:gs("Additional sites available in the Vault"),contexts:[l],parentId:n[t],onclick:openvault}))}function v(e){if(void 0===g_prefoverrides.show_formfills||"1"===g_prefoverrides.show_formfills){for(var t=e?6:3,c=0,r=0;r<g_formfills.length;r++)if(check_ident_ffid(g_formfills[r].ffid)){n[n.length]=chrome.contextMenus.create({title:g_formfills[r].decprofilename,contexts:[l],parentId:n[t]});var i=chrome.contextMenus.create({title:gs("Fill Form"),contexts:[l],parentId:n[n.length-1],onclick:g});o[i]=g_formfills[r].ffid;var i=chrome.contextMenus.create({title:gs("Edit"),contexts:[l],parentId:n[n.length-1],onclick:h});if(o[i]=g_formfills[r].ffid,(c+=1)>=a)break}n[n.length]=chrome.contextMenus.create({type:"separator",contexts:[l],parentId:n[t]}),n[n.length]=chrome.contextMenus.create({title:gs("Add Profile"),contexts:[l],parentId:n[t],onclick:function(){addprofile(null,"context")}}),n[n.length]=chrome.contextMenus.create({title:gs("Add Credit Card"),contexts:[l],parentId:n[t],onclick:function(){addcreditcard(null,"context")}}),n[n.length]=chrome.contextMenus.create({title:gs("Clear Forms"),contexts:[l],parentId:n[t],onclick:function(){clearforms("context")}}),n[n.length]=chrome.contextMenus.create({title:gs("Choose Profile and Credit Card"),contexts:[l],parentId:n[t],onclick:function(){openchooseprofilecc("context")}}),c>a&&(n[n.length]=chrome.contextMenus.create({type:"separator",contexts:[l],parentId:n[t]}),n[n.length]=chrome.contextMenus.create({title:gs("Additional form fills available in the Vault"),contexts:[l],parentId:t,onclick:openvault}))}}function _(t,o){if(lploggedin){n[n.length]=chrome.contextMenus.create({title:gs("AutoFill"),contexts:[l],parentId:e}),o&&(n[n.length]=chrome.contextMenus.create({title:gs("Copy Username"),contexts:[l],parentId:e}),n[n.length]=chrome.contextMenus.create({title:gs("Copy Password"),contexts:[l],parentId:e}),n[n.length]=chrome.contextMenus.create({title:gs("Copy URL"),contexts:[l],parentId:e})),n[n.length]=chrome.contextMenus.create({title:gs("Recheck Page"),contexts:[l],parentId:e,onclick:function(e,t){recheckpage()}}),n[n.length]=chrome.contextMenus.create({title:gs("Generate Secure Password"),contexts:[l],parentId:e,onclick:opengenpw}),void 0!==g_prefoverrides.show_formfills&&"1"!==g_prefoverrides.show_formfills||(n[n.length]=chrome.contextMenus.create({title:gs("Fill Forms"),contexts:[l],parentId:e}));for(var c=o?3:0,r=0;r<=c;r++)t.length>0?y(t,r):chrome.contextMenus.create({title:gs("No Matching Sites!"),contexts:[l],parentId:n[r]});v(o)}}function C(t,o,c){return n[n.length]=chrome.contextMenus.create({title:gs(t),contexts:[l],parentId:c||e,onclick:o})}function M(e,t,i,a,s,u){var d=chrome.contextMenus.create({title:gs(t),contexts:[l],parentId:n[n.length-1],onclick:s});null!=d&&(o[d]=e,null!=i&&(c[d]=i,r[d]=a))}function b(t,n){var o=t.length<a?t.length:a;t.slice(0,o).forEach(function(e){var t=e.useusername?" - "+e.useusername:"";C(e.name+t),M(e.aid,"Fill",null,null,s),M(e.aid,"Edit",null,null,x),n&&(M(e.aid,"Copy username","Username",null,u),M(e.aid,"Copy password","Password",null,d))}),chrome.contextMenus.create({type:"separator",contexts:[l],parentId:e});for(var c=C("Other"),r=Object.keys(g_securenotes),i=[],p=0;p<r.length&&i.length<a;p++)check_ident_aid(g_securenotes[r[p]].aid)&&fillableNoteTypes.indexOf(g_securenotes[r[p]].notetype)>-1&&i.push(addUserFriendlyDescription(g_securenotes[r[p]]));i.sort(function(e,t){return e.name&&t.name?e.name.localeCompare(t.name):0});for(var g=i.length<a?i.length:a,p=0;p<g;p++){var h=i[p];if(C(h.description?h.decprofilename+"  -  "+h.description:h.decprofilename,null,c),M(h.aid,"Fill",null,null,f),M(h.aid,"Edit",h.notetype,null,I),n)switch(h.notetype){case"Credit Card":M(h.aid,"Copy card number","Number",null,m),M(h.aid,"Copy CVV/Security code","Security Code",null,m);break;case"Bank Account":M(h.aid,"Copy account number","Account Number",null,m),M(h.aid,"Copy routing number","Routing Number",null,m);break;case"Address":M(h.aid,"Copy first name","First Name",null,m),M(h.aid,"Copy last name","Last Name",null,m),M(h.aid,"Copy address 1","Address 1",null,m),M(h.aid,"Copy city/town","City / Town",null,m),M(h.aid,"Copy zip/postal code","Zip / Postal Code",null,m),M(h.aid,"Copy email address","Email Address",null,m),M(h.aid,"Copy phone number","Phone","num",m)}}chrome.contextMenus.create({type:"separator",contexts:[l],parentId:e}),(o>a||g>a)&&chrome.contextMenus.create({title:gs("Additional items available in the Vault"),contexts:[l],parentId:e,onclick:openvault}),C("Add Item",function(){openaddsecurenote()}),C("Recheck Page",function(e,t){recheckpage()}),C("Generate Secure Password",opengenpw)}function k(e){if(setcurrenturl(e),"undefined"!=typeof chrome&&void 0!==chrome.contextMenus&&!g_issafari&&!g_ismaxthon&&1!=lpGetPref("hideContextMenus",0)&&t!=e)if(t=e,n.length)P(function(){t=null,k(e)});else if(o=[],lploggedin){var c=lp_gettld_url(e),r=reorderOnURL(getsites(c),e,!0,!1),l=can_copy_to_clipboard()&&!g_isedge;LPContentScriptFeatures.omaria?b(r,l):_(r,l)}}function P(t){lpdbg("context","createContextMenus called"),"undefined"==typeof chrome||void 0===chrome.contextMenus||i&&1!=lpGetPref("hideContextMenus",0)&&!t||(lpdbg("context","not created yet or preference changed"),chrome.contextMenus.removeAll(function(){lpdbg("context","context menu items all removed"),i=!1,n=[],0==lpGetPref("hideContextMenus",0)&&(lpdbg("context","creating context menu"),t||(t=w),e=chrome.contextMenus.create({title:gs("LastPass"),contexts:["all"],onclick:L},t))}))}function w(){console_log("Context menu callback function called"),i=!0}function L(e,t){if(lploggedin){if(g_issafari){var n=[],o=[];if(LPContentScriptFeatures.omaria)Object.keys(g_securenotes).forEach(function(e){check_ident_aid(g_securenotes[e].aid)&&isFillableNoteType(g_securenotes[e].notetype)&&o.push(g_securenotes[e])});else for(var c=0;c<g_formfills.length;c++)check_ident_ffid(g_formfills[c].ffid)&&(n[n.length]=g_formfills[c]);get_selected_tab(null,function(e){var t=lp_gettld_url(gettaburl(e));sendCS(gettabid(e),{cmd:"showcontext",sites:cache_usernames(reorderOnURL(getsites(t),gettaburl(e),!0,!0)),formfills:LPJSON.stringify(n),securenotes:LPJSON.stringify(o),can_copy:can_copy_to_clipboard()},"all")})}}else open_login()}return P(),{rebuildcontext:k,createContextMenus:P,cm_handler:L,lastcontexturl:t}}();
//# sourceMappingURL=sourcemaps/context-menu.js.map
